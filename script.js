const DataAD = [
    {
        id: 1,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "التغذية السليمة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 2,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "النشاط البدني وممارسة الرياضة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 3,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "مكافحة التدخين والادمان",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 4,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "العمود الفقري وضعف الابصار",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 5,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "النظافة الشخصية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 6,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "صحة الفم والاسنان",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 7,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "تغذية ما قبل واثناء الحمل وبعد الولادة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 8,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "إدمان الانترنت والهواتف الذكية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 9,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "سواء استخدام المضدات الحيوية والعقاقير",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 10,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "امراض القلب والاوعية الدموية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 11,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "داء السكري",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 12,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "ارتفاع ضغط الدم",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 13,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "الأورام",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 14,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "السمنة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 15,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الامراض الطفيلية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 16,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الإلتهاب الكبدي الفيروسي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 17,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الإنفلونزا الموسمية والمستجدة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 18,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الدرن",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 19,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الامراض المنقولة جنسياً الإيدز",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 20,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الحصبة والحصبة الالماني",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 21,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "كوفيد 19 - فيروس كورونا المستجد",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 22,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "نقص هرمون الغدة الدرقية وامراض التمثيل الغدائي والفحص السمعي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 23,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "البطاقة الصحية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 24,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "تطعيمات الاطفال",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 25,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "رعاية المولود حديث الولادة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 26,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "الرضاعة الطبيعية والتغذية التكميلية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 27,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "سوء التغذية (سمنة - تقزم - نقص الوزن - انميا)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 28,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "أمراض الجهاز التنفسي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 29,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "الإسهال والجفاف",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 30,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "التشجيع على الولادة الطبيعية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 31,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "السلامة المنزلية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 32,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الإسعافات الاولية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 33,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الفحوص الطبية الروتينية والفحوص الدورية للسيدات",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 34,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الصحة النفسية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 35,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "رعاية المسنين",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 36,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "رعاية ذوي الاحتياجات الخاصة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 37,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "أهمية التبرع بالدم / التبرع بالبلازما",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 38,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الأمراض الجلدية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 39,
        MainTopic: "صحة البيئة",
        Subtopic: "التغيرات المناخية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 40,
        MainTopic: "صحة البيئة",
        Subtopic: "الحد من استخدام البلاستيك الأحادي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 41,
        MainTopic: "صحة البيئة",
        Subtopic: "البيئة الصحية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 42,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "القضاء على فيروس سي والكشف عن الأمراض المعدية غير السارية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 43,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "دعم صحة المرأة المصرية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 44,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "دعم صحة الأم والجنين",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 45,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "اكتشاف وعلاج ضعف وفقدان السمع للأطفال حديثي الولادة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 46,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "متابعة وعلاج الأمراض المزمنة والكشف المبكر عن الاعتلال الكلوي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 47,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف عن السمنة والأنميا والتقزم لطلاب المدارس الإبتدائية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 48,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "إنهاء قوائم الانتظار",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 49,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الرعاية الصحية والنفسية المستمرة لكبار السن",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 50,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف عن فيرس سي بين طلاب المدارس الإعدادية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 51,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف المبكر عن الامراض الوراثية للأطفال حديثي الولادة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 52,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "حياة كريمة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 53,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مرضي ضمور العضلات",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 54,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة ايامنا أحلي (رفع الوعي الصحي للشرائح العمرية والمجتمعية المختلفة بأهمية تنظيم الإسرة)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 55,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة المشروع القومي لتنمية الاسرة المصرية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 56,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة فحص المقبلين على الزواج",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 57,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة الكشف المبكر وعلاج الأورام السرطانية",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 58,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة 100 يوم صحة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 59,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة رئيس الجمهورية للتنمية البشرية(بداية)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 60,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة رئيس الجمهورية (الألف يوم الذهبية لتنمية الأسرة المصرية)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 61,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة كل ثانية حياة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 62,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "سمكة القراض (الأرنب)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 63,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "جدري القرود",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 64,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "الفيروس التنفسي المخلوي",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 65,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "مشروبات الطاقة",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 66,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "التوعية بالسعار(داء الكلب)",
        in: false,
        out: false,
        child: 0,
        men: 0,
        women: 0,
    },

];
const DataN = [
    {
        id: 1,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "التغذية السليمة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 2,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "النشاط البدني وممارسة الرياضة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 3,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "مكافحة التدخين والادمان",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 4,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "العمود الفقري وضعف الابصار",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 5,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "النظافة الشخصية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 6,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "صحة الفم والاسنان",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 7,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "تغذية ما قبل واثناء الحمل وبعد الولادة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 8,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "إدمان الانترنت والهواتف الذكية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 9,
        MainTopic: "بيان النمط السليم للحياة الصحية",
        Subtopic: "سواء استخدام المضدات الحيوية والعقاقير",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 10,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "امراض القلب والاوعية الدموية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 11,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "داء السكري",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 12,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "ارتفاع ضغط الدم",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 13,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "الأورام",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 14,
        MainTopic: "بيان التوعية للوقاية والإكتشاف المبكر للأمراض غير المعدية",
        Subtopic: "السمنة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 15,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الامراض الطفيلية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 16,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الإلتهاب الكبدي الفيروسي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 17,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الإنفلونزا الموسمية والمستجدة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 18,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الدرن",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 19,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الامراض المنقولة جنسياً الإيدز",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 20,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "الحصبة والحصبة الالماني",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 21,
        MainTopic: "بيان الوقاية من الامراض المعدية",
        Subtopic: "كوفيد 19 - فيروس كورونا المستجد",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 22,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "نقص هرمون الغدة الدرقية وامراض التمثيل الغدائي والفحص السمعي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 23,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "البطاقة الصحية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 24,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "تطعيمات الاطفال",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 25,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "رعاية المولود حديث الولادة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 26,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "الرضاعة الطبيعية والتغذية التكميلية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 27,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "سوء التغذية (سمنة - تقزم - نقص الوزن - انميا)",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 28,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "أمراض الجهاز التنفسي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 29,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "الإسهال والجفاف",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 30,
        MainTopic: "بيان صحة الطفل",
        Subtopic: "التشجيع على الولادة الطبيعية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 31,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "السلامة المنزلية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 32,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الإسعافات الاولية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 33,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الفحوص الطبية الروتينية والفحوص الدورية للسيدات",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 34,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الصحة النفسية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 35,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "رعاية المسنين",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 36,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "رعاية ذوي الاحتياجات الخاصة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 37,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "أهمية التبرع بالدم / التبرع بالبلازما",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 38,
        MainTopic: "بيان الصحة العامة",
        Subtopic: "الأمراض الجلدية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 39,
        MainTopic: "صحة البيئة",
        Subtopic: "التغيرات المناخية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 40,
        MainTopic: "صحة البيئة",
        Subtopic: "الحد من استخدام البلاستيك الأحادي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 41,
        MainTopic: "صحة البيئة",
        Subtopic: "البيئة الصحية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 42,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "القضاء على فيروس سي والكشف عن الأمراض المعدية غير السارية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 43,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "دعم صحة المرأة المصرية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 44,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "دعم صحة الأم والجنين",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 45,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "اكتشاف وعلاج ضعف وفقدان السمع للأطفال حديثي الولادة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 46,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "متابعة وعلاج الأمراض المزمنة والكشف المبكر عن الاعتلال الكلوي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 47,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف عن السمنة والأنميا والتقزم لطلاب المدارس الإبتدائية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 48,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "إنهاء قوائم الانتظار",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 49,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الرعاية الصحية والنفسية المستمرة لكبار السن",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 50,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف عن فيرس سي بين طلاب المدارس الإعدادية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 51,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "الكشف المبكر عن الامراض الوراثية للأطفال حديثي الولادة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 52,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "حياة كريمة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 53,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مرضي ضمور العضلات",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 54,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة ايامنا أحلي (رفع الوعي الصحي للشرائح العمرية والمجتمعية المختلفة بأهمية تنظيم الإسرة)",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 55,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة المشروع القومي لتنمية الاسرة المصرية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 56,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة فحص المقبلين على الزواج",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 57,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة الكشف المبكر وعلاج الأورام السرطانية",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 58,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة 100 يوم صحة",
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 59,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة رئيس الجمهورية للتنمية البشرية(بداية)",
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 60,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة رئيس الجمهورية (الألف يوم الذهبية لتنمية الأسرة المصرية)",
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 61,
        MainTopic: "مبادرات رئاسية وحملات توعية",
        Subtopic: "مبادرة كل ثانية حياة",
        child: 0,
        men: 0,
        women: 0,
    },
    {
        id: 62,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "سمكة القراض (الأرنب)",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 63,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "جدري القرود",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 64,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "الفيروس التنفسي المخلوي",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 65,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "مشروبات الطاقة",
        women: 0,
        child: 0,
        men: 0,

    },
    {
        id: 66,
        MainTopic: "موضوعات صحية مستحدثة / اخري",
        Subtopic: "التوعية بالسعار(داء الكلب)",
        child: 0,
        men: 0,
        women: 0,
    },
];

var normal = document.getElementById("normal");
var advanced = document.getElementById("advanced");
var normalCon = document.getElementById("normalCon");
var advancedCon = document.getElementById("advancedCon");
normal.addEventListener("click", function () {
    if (!(normal.classList.contains("disabled"))) {
        advancedCon.style.display = "none";
        normalCon.style.display = "block";
        normal.classList.add("disabled");
        advanced.classList.remove("disabled");
    }
})
advanced.addEventListener("click", function () {
    if (!(advanced.classList.contains("disabled"))) {
        advancedCon.style.display = "block";
        normalCon.style.display = "none";
        normal.classList.remove("disabled");
        advanced.classList.add("disabled");

    }
})


var tablegroupdivider = document.querySelector(".table-group-divider");
// console.log(tablegroupdivider);
// var advancedDit = {
//     in: [],
//     out: [],
// }
window.onload = function () {
    DataAD.forEach((element) => {
        tablegroupdivider.innerHTML += `
        <tr>
            <td>${element.id}</td>
            <td>${element.MainTopic}</td>
            <td>${element.Subtopic}</td>
            <td><input type="checkbox" name="" id="${element.id}in" class="checkBox" onclick="inCheck(\`${element.id}in\`)"></td>
            <td><input type="checkbox" name="" id="${element.id}out"  class="checkBox" onclick="outCheck(\`${element.id}out\`)"></td>
            <td><input type="number" name="" id="${element.id}child"  class="numbIn" onblur="childNe(\`${element.id}child\`)"></td>
            <td><input type="number" name="" id="${element.id}man"  class="numbIn" onblur="manNe(\`${element.id}man\`)"></td>
            <td><input type="number" name="" id="${element.id}woman"  class="numbIn" onblur="womanNe(\`${element.id}woman\`)"></td>
        </tr>
        `
    })
}
//////////////////////////////////////////////////
function childNe(e) {
    let val = document.getElementById(e).value;
    if (val) {
        DataAD[parseInt(e) - 1].child = +(val);
        // console.log(parseInt(e) - 1);
        // console.log(val);

    }
}
function manNe(e) {
    let val = document.getElementById(e).value;
    if (val) {
        DataAD[parseInt(e) - 1].men = +(val);
        // console.log(parseInt(e) - 1);
        // console.log(val);

    }
}
function womanNe(e) {
    let val = document.getElementById(e).value;
    if (val) {
        DataAD[parseInt(e) - 1].women = +(val);
        // console.log(parseInt(e) - 1);
        // console.log(val);

    }
}
//////////////////////////////////////////////////
var child = 0, man = 0, woman = 0;
var womenInput = document.getElementById("women");
var menInput = document.getElementById("men")
var childInput = document.getElementById("child");

document.querySelector(".done").onclick = function () {
    if (!(document.querySelector(".done").classList.contains("disabled"))) {
        child = +(childInput.value);
        man = +(menInput.value);
        woman = +(womenInput.value);
        DataN.forEach(ele => {
            ele.child = child;
            ele.men = man;
            ele.women = woman;
        })
        // console.log(DataN);
        childInput.setAttribute("disabled", "");
        menInput.setAttribute("disabled", "");
        womenInput.setAttribute("disabled", "");
        document.querySelector(".done").classList.add("disabled");
        document.querySelector(".reset").classList.remove("disabled");
    }
}

document.querySelector(".reset").onclick = function () {
    if (!(document.querySelector(".reset").classList.contains("disabled"))) {
        // console.log(child + " " + man + " " + woman);
        document.getElementById("child").removeAttribute("disabled");
        document.getElementById("men").removeAttribute("disabled");
        document.getElementById("women").removeAttribute("disabled");
        document.getElementById("child").value = "";
        document.getElementById("men").value = "";
        document.getElementById("women").value = "";
        document.querySelector(".done").classList.remove("disabled");
        document.querySelector(".reset").classList.add("disabled");
    }
}
////////////////////////////////////////////////

function inCheck(n) {
    let test = document.getElementById(n);
    let num = parseInt(n);
    let botion = DataAD.findIndex(ele => ele.id === num);

    if (test.checked) {
        test.parentElement.parentElement.classList.add("in");
        DataAD[botion].in = true;

    } else {
        test.parentElement.parentElement.classList.remove("in");
        DataAD[botion].in = false;
    }
    // console.log(DataAD);
    bothCheck(n);
}
function outCheck(n) {
    let test = document.getElementById(n);
    let num = parseInt(n);
    let botion = DataAD.findIndex(ele => ele.id === num);
    if (test.checked) {
        test.parentElement.parentElement.classList.add("out");
        DataAD[botion].out = true;
    } else {
        test.parentElement.parentElement.classList.remove("out");
        DataAD[botion].out = false;
    }
    bothCheck(n);
    // console.log(DataAD);
}
function bothCheck(n) {
    let test = document.getElementById(n);
    if (test.parentElement.parentElement.classList.contains("in") && test.parentElement.parentElement.classList.contains("out")) {
        test.parentElement.parentElement.classList.add("both");
    } else {
        test.parentElement.parentElement.classList.remove("both");
    }
}
////////////////////////////////////////////////

var daysCon = {
    in: [],
    out: [],
    bothINday: "",
};
var startDateInput = document.getElementById("startDate");
var endDateInput = document.getElementById("endDate");
var startDate, endDate;
var dataSelectIN = document.querySelectorAll("#dataSelect .inWeek input[type=checkbox]");
var dataSelectOUT = document.querySelectorAll("#dataSelect .outWeek input[type=checkbox]");
var generate = document.querySelector(".generate");
var bothINday = document.getElementById("bothINday");
var supDate = document.querySelector(".supDate");
var inandoutChose = document.querySelectorAll(".bothInDay")
// console.log(inandoutChose)
supDate.onclick = () => {
    daysCon = {
        in: [],
        out: [],
        bothINday: "",
    };
    startDate = new Date(startDateInput.value);
    endDate = new Date(endDateInput.value);
    dataSelectIN.forEach((e) => {
        if (e.checked) {
            daysCon.in.push(+(e.value));
        }
    })
    dataSelectOUT.forEach((e) => {
        if (e.checked) {
            daysCon.out.push(+(e.value));
        }
    })

    // console.log(daysCon);
    generate.classList.remove("disabled");
}
////////////////////////////////////////////////////////////////////
var monthNames = [
    "يناير", "فبراير", "مارس", "أبريل", "مايو", "يونيو",
    "يوليو", "أغسطس", "سبتمبر", "أكتوبر", "نوفمبر", "ديسمبر"
];
var daysOfWeek = ["الأحد", "الاثنين", "الثلاثاء", "الأربعاء", "الخميس", "الجمعة", "السبت"];

function sortTopic(array) {
    const x = {};
    array.sort((a, b) => {
        if (a.year !== b.year) {
            return a.year - b.year;
        }
        if (a.month !== b.month) {
            return a.month - b.month;
        }
        return a.day - b.day;
    });
    array.forEach(element => {
        if (element.day <= 25) {
            if (x[`${element.month}-${element.year}`]) {
                x[`${element.month}-${element.year}`].push(element);
            } else {
                x[`${element.month}-${element.year}`] = [element];
            }

        } else {
            if (element.month != 12) {
                if (x[`${element.month + 1}-${element.year}`]) {
                    x[`${element.month + 1}-${element.year}`].push(element);
                } else {
                    x[`${element.month + 1}-${element.year}`] = [element];
                }
            } else {
                if (x[`${1}-${element.year + 1}`]) {
                    x[`${1}-${element.year + 1}`].push(element);
                } else {
                    x[`${1}-${element.year + 1}`] = [element];
                }
            }
        }
    });
    return x;
}

function drowTopic(object) {
    var tbody = document.getElementById("tbody");
    tbody.innerHTML = '';
    Object.keys(object).forEach(ele => {
        let detti = ele.split("-");
        tbody.innerHTML += `<tr>
        <td colspan="12" class="titelTopics fw-bolder">الجلسات التثقيفية عن شهر ${detti[0]} لعام ${detti[1]}</td>
        </tr>
        `
        object[ele].forEach(i => {
            let formattedDate = i.day + "/" + i.month + "/" + i.year;
            tbody.innerHTML += `          
            <tr class = ${i.in ? "inter" : "outter"}>
            <td>${i.counter}</td>
            <td>${formattedDate}</td>
            <td>${i.dayWeek}</td>
            <td>${i.MainTopic}</td>
            <td>${i.Subtopic}</td>
            <td colspan="2" class="fw-bold">${i.in ? "داخلية" : "خارجية"}</td>
            <td>${i.child}</td>
            <td>${i.men}</td>
            <td>${i.women}</td>
            <td class ="${i.cahnged ? "retopict" : ""}"><i class="fa-solid fa-recycle reTopic" onclick = "reTopic(${i.counter})"></i></td>
            <td><i class="fa-solid fa-trash-can deleteTopic" onclick = "deleteTopic(${i.counter})"></i></td>
            </tr>
            `
        })
        // console.log(ele)
    })
    tbody.innerHTML += `          
    <tr class = "NewTopicL" onclick = "AddNewTopic()">
    <td colspan = "12"><i class="fa-solid fa-circle-plus"></i></td>
    </tr>
    `;
}



var DoneAll = [];
var tobo = document.querySelector(".table_group");
var generateMonthYear = document.querySelector(".generateMonthYear");

generate.addEventListener("click", () => {
    var counter = 1;
    DoneAll = [];
    tobo.innerHTML = "";
    tobo.innerHTML = ` 
    <thead class="table-group-divider">
    <th>م</th>
    <th>التاريخ</th>
    <th>اليوم</th>
    <th>الموضوع الرئيسي</th>
    <th>الموضوع الفرعي</th>
    <th>خارجية</th>
    <th>داخلية</th>
    <th>اطفال</th>
    <th>ذكور</th>
    <th>إناث</th>
    <th style ="width : 7%;">تعديل</th>
    <th style ="width : 7%;">حذف</th>
    </thead>
    <tbody id="tbody">
    <!-- ////// -->
    </tbody>`;
    // tbody.innerHTML = "";
    var tbody = document.getElementById("tbody");
    let helper = new Date(startDate);
    let especifcIN = DataAD.filter(ele => ele.in);
    let especifcOut = DataAD.filter(ele => ele.out);
    var directDetiIn = (normal.classList.contains("disabled")) ? DataN : especifcIN;
    var directDetiOut = (normal.classList.contains("disabled")) ? DataN : especifcOut;
    let maxRandomIn = directDetiIn.length;
    let maxRandomOut = directDetiOut.length;
    // console.log(directDetiIn);
    // let currentMon = startDate.getMonth() + 1;
    // let currentDay = startDate.getDate();
    // let currentYear = startDate.getFullYear();
    while (startDate <= endDate) {


        var day = startDate.getDate();
        var month = startDate.getMonth() + 1; // يضاف واحد لأن الشهور تبدأ من 0
        var year = startDate.getFullYear();
        var formattedDate = day + "/" + month + "/" + year;
        let checkIn = daysCon.in.includes(startDate.getDay());
        let checkOut = daysCon.out.includes(startDate.getDay());
        if (checkIn) {
            let randomNumber = Math.floor(Math.random() * (maxRandomIn - 0 + 0)) + 0;
            // let trueObg = directDetiIn[randomNumber];
            ////////////////////////////////////////////
            var newop = {
                year: year,
                month: month,
                day: day,
                men: directDetiIn[randomNumber].men,
                child: directDetiIn[randomNumber].child,
                women: directDetiIn[randomNumber].women,
                MainTopic: directDetiIn[randomNumber].MainTopic,
                Subtopic: directDetiIn[randomNumber].Subtopic,
                id: directDetiIn[randomNumber].id,
                in: true,
                out: false,
                counter: counter,
                dayWeek: daysOfWeek[startDate.getDay()],
            }
            DoneAll.push(newop);
            counter++;
        }

        if (checkOut) {
            let randomNumber = Math.floor(Math.random() * (maxRandomOut - 0 + 0)) + 0;
            ////////////////////////////////////////////
            var newop = {
                year: year,
                month: month,
                day: day,
                men: directDetiOut[randomNumber].men,
                child: directDetiOut[randomNumber].child,
                women: directDetiOut[randomNumber].women,
                MainTopic: directDetiOut[randomNumber].MainTopic,
                Subtopic: directDetiOut[randomNumber].Subtopic,
                id: directDetiOut[randomNumber].id,
                in: false,
                out: true,
                counter: counter,
                dayWeek: daysOfWeek[startDate.getDay()],
            }
            DoneAll.push(newop);
            counter++;
        }
        startDate.setDate(startDate.getDate() + 1); // يزيد التاريخ بيوم واحد
    }

    // console.log(sortTopic(DoneAll));
    drowTopic(sortTopic(DoneAll))

    startDate = helper;
    document.querySelector(".topicContan").style.display = "block";
    generateMonthYear.classList.remove("disabled");
    ////////////////////////////////////////////////
    // console.log(DoneAll);

})


function deleteTopic(e) {
    // console.log(dataMontlyAll)
    let ind = DoneAll.findIndex(ele => ele.counter == e);
    DoneAll.splice(ind, 1);
    // console.log(DoneAll)
    drowTopic(sortTopic(DoneAll));
}
/////////////////////////////////////////////////////////////////////
var overLay = document.querySelector(".overLay");
var Save_overLay = document.querySelector(".Save_overLay");
var Close_overLay = document.querySelector(".Close_overLay");
function reTopic(e) {
    let ind = DoneAll.findIndex(ele => ele.counter == e);
    let ele = DoneAll[ind];
    console.log(DoneAll);


    let oldDeta = `${ele.year}-${ele.month < 10 ? `0${ele.month}` : ele.month}-${ele.day < 10 ? `0${ele.day}` : ele.day}`;
    let startDetaLimit = `${startDate.getFullYear()}-${(startDate.getMonth() + 1) < 10 ? `0${(startDate.getMonth() + 1)}` : (startDate.getMonth() + 1)}-${(startDate.getDate()) < 10 ? `0${(startDate.getDate())}` : (startDate.getDate())}`;
    let endDetaLimit = `${endDate.getFullYear()}-${(endDate.getMonth() + 1) < 10 ? `0${(endDate.getMonth() + 1)}` : (endDate.getMonth() + 1)}-${(endDate.getDate()) < 10 ? `0${(endDate.getDate())}` : (endDate.getDate())}`;
    // console.log(oldDeta);

    const uniqueSubtopics = [...new Set(DataN.map(item => item.MainTopic))];
    // console.log(uniqueSubtopics);

    overLay.innerHTML = "";
    overLay.innerHTML += `<div class="befor-element" onclick="closeLay()"></div>`;
    overLay.innerHTML += `
    <div class="inputs-contain">
    <p class="fw-bold m-0">المسلسل :${ele.counter}</p>
    <div class="form1">
      <div><p for="startDate" class="m-0">التاريخ</p><input type="date" id="startDateTime" name="startDate" value="${oldDeta}" max="${endDetaLimit}" min="${startDetaLimit}"></div>
      <div><p for="startDate" class="m-0">الموضوع الرئيسي</p><select name="" id="MainTopicEsp" onchange = "supTop()"><option value=""></option></select></div>
      <div><p for="startDate" class="m-0">الموضوع الفرعي</p><select name="" id="SupTopicEsp" ><option value=""></option></select></div>
      <div><p for="startDate" class="m-0">مكان الندوة</p><select name="" id="INoutCONDETION" value = "">
      <option value="خارجية">خارجية</option>
      <option value="داخلية">داخلية</option>
      </select></div>
      <div><p for="startDate" class="m-0">أطفال</p><input type="number" name="" id="childchange" min="0" max="1000" value ="${ele.child}"></div>
      <div><p for="startDate" class="m-0">ذكور</p><input type="number" name="" id="manchange" min="0" max="1000" value ="${ele.men}"></div>
      <div><p for="startDate" class="m-0">إناث</p><input type="number" name="" id="womanchange" min="0" max="1000" value ="${ele.women}"></div>

    </div>
    <div class="bottonssd d-flex justify-content-start ">
      <button type="button" class="btn btn-primary mx-2 Save_overLay"onclick = "saveChangesLay(${ind})">حفظ</button>
      <button type="button" class="btn btn-danger mx-2 Close_overLay" onclick = "closeLay()">اغلاق</button>
    </div>
    </div>
  `
    var MainTopicEsp = document.getElementById("MainTopicEsp");
    MainTopicEsp.innerHTML = ``;
    uniqueSubtopics.forEach(e => {
        MainTopicEsp.innerHTML += `<option value="${e}">${e}</option>`;
    })
    MainTopicEsp.value = ele.MainTopic;
    let SupTopicEsp = document.getElementById("SupTopicEsp")
    supTop();
    SupTopicEsp.value = ele.Subtopic;
    let INoutCONDETION = document.getElementById("INoutCONDETION")
    INoutCONDETION.value = ele.in ? "داخلية" : "خارجية";

    overLay.style.display = "flex";
}
function supTop() {
    let SupTopicEsp = document.getElementById("SupTopicEsp")
    let NowOn = MainTopicEsp.value;
    let Allsup = DataN.filter(e => e.MainTopic == NowOn)
    SupTopicEsp.innerHTML = '';
    Allsup.forEach(e => {
        SupTopicEsp.innerHTML += `<option value="${e.Subtopic}">${e.Subtopic}</option>`;
    })
    SupTopicEsp.value = "";
}
// console.log(Close_overLay)
function saveChangesLay(params) {
    // console.log(params)
    // console.log(DoneAll)
    let realIndex = DoneAll.findIndex(ele => ele.counter == params);
    let SupTopicSave = document.getElementById("SupTopicEsp");
    if (SupTopicSave.value) {
        let dateTime = new Date(document.getElementById("startDateTime").value);
        var dayo = dateTime.getDate();
        DoneAll[params].day = dayo;
        var montho = dateTime.getMonth() + 1; // يضاف واحد لأن الشهور تبدأ من 0
        DoneAll[params].month = montho;
        var yearo = dateTime.getFullYear();
        DoneAll[params].year = yearo;
        var formattedDateo = dayo + "/" + montho + "/" + yearo;
        var dayweeko = daysOfWeek[dateTime.getDay()];
        DoneAll[params].dayWeek = dayweeko;
        DoneAll[params].cahnged = true;
        // console.log(formattedDateo);
        // console.log(dayweeko);

        let MainTopicSave = document.getElementById("MainTopicEsp").value;
        DoneAll[params].MainTopic = MainTopicSave;

        DoneAll[params].Subtopic = SupTopicSave.value;
        let INoutCONDETION = document.getElementById("INoutCONDETION").value;
        if (INoutCONDETION == "داخلية") {
            DoneAll[params].in = true;
            DoneAll[params].out = false;
        } else if (INoutCONDETION == "خارجية") {
            DoneAll[params].in = false;
            DoneAll[params].out = true;
        }

        let childchange = Number(document.getElementById("childchange").value);
        let manchange = Number(document.getElementById("manchange").value);
        let womanchange = Number(document.getElementById("womanchange").value);
        DoneAll[params].child = childchange;
        DoneAll[params].men = manchange;
        DoneAll[params].women = womanchange;
        DoneAll[params].id = DataN.find(e => e.Subtopic == SupTopicSave.value).id;

        drowTopic(sortTopic(DoneAll));

        overLay.style.display = "none";
    } else {
        alert("من فضلك تأكد من اختيار الموضوع الفرعي");
        SupTopicSave.style.border = "2px solid red ";
    }
}
//////////////////////////////////////////////////////////////////////////////////
function AddNewTopic() {
    // console.log(6);
    let startDetaLimit = `${startDate.getFullYear()}-${(startDate.getMonth() + 1) < 10 ? `0${(startDate.getMonth() + 1)}` : (startDate.getMonth() + 1)}-${(startDate.getDate()) < 10 ? `0${(startDate.getDate())}` : (startDate.getDate())}`;
    let endDetaLimit = `${endDate.getFullYear()}-${(endDate.getMonth() + 1) < 10 ? `0${(endDate.getMonth() + 1)}` : (endDate.getMonth() + 1)}-${(endDate.getDate()) < 10 ? `0${(endDate.getDate())}` : (endDate.getDate())}`;
    let max = 0;
    for (let i of DoneAll) {
        if (i.counter > max) {
            max = i.counter;
        }
    }
    max++;
    overLay.innerHTML = "";
    overLay.innerHTML += `<div class="befor-element" onclick="closeLay()"></div>`;
    overLay.innerHTML += `
    <div class="inputs-contain">
    <p class="fw-bold m-0">المسلسل :${max}</p>
    <div class="form1">
      <div><p for="startDate" class="m-0">التاريخ</p><input type="date" id="startDateTime" name="startDate"  max="${endDetaLimit}" min="${startDetaLimit}"></div>
      <div><p for="startDate" class="m-0">الموضوع الرئيسي</p><select name="" id="MainTopicEsp" onchange = "supTop()"><option></option></select></div>
      <div><p for="startDate" class="m-0">الموضوع الفرعي</p><select name="" id="SupTopicEsp" ><option value=""></option></select></div>
      <div><p for="startDate" class="m-0">مكان الندوة</p><select name="" id="INoutCONDETION" value = "">
      <option value="" hidden></option>
      <option value="خارجية">خارجية</option>
      <option value="داخلية">داخلية</option>
      </select></div>
      <div><p for="startDate" class="m-0">أطفال</p><input type="number" name="" id="childchange" min="0" max="1000" ></div>
      <div><p for="startDate" class="m-0">ذكور</p><input type="number" name="" id="manchange" min="0" max="1000" ></div>
      <div><p for="startDate" class="m-0">إناث</p><input type="number" name="" id="womanchange" min="0" max="1000" ></div>

    </div>
    <div class="bottonssd d-flex justify-content-start ">
      <button type="button" class="btn btn-primary mx-2 Save_overLay"onclick = "acceptNewTopic(${max})">حفظ</button>
      <button type="button" class="btn btn-danger mx-2 Close_overLay" onclick = "closeLay()">اغلاق</button>
    </div>
    </div>
  `;
    const uniqueSubtopics = [...new Set(DataN.map(item => item.MainTopic))];
    var MainTopicEsp = document.getElementById("MainTopicEsp");
    MainTopicEsp.innerHTML = `<option value="" hidden></option>`;
    uniqueSubtopics.forEach(e => {
        MainTopicEsp.innerHTML += `<option value="${e}">${e}</option>`;
    })

    overLay.style.display = "block";
}

function acceptNewTopic(params) {

    let dateN = new Date(document.getElementById("startDateTime").value);
    let day = dateN.getDate();
    let month = dateN.getMonth() + 1; // يضاف واحد لأن الشهور تبدأ من 0
    let year = dateN.getFullYear();
    let formattedDateN = day + "/" + month + "/" + year; // التاريخ

    let dayWeaka = daysOfWeek[dateN.getDay()]; // اليوم في الأسبوع
    // console.log(formattedDateN, dayWeaka);

    let INoutCONDETION = document.getElementById("INoutCONDETION").value;


    let MainTopicEsp = document.getElementById("MainTopicEsp").value;
    let SupTopicSave = document.getElementById("SupTopicEsp").value;

    let childchange = Number(document.getElementById("childchange").value);
    let manchange = Number(document.getElementById("manchange").value);
    let womanchange = Number(document.getElementById("womanchange").value);
    // console.log(childchange)


    if (dayWeaka && MainTopicEsp && SupTopicSave && INoutCONDETION) {
        let eleM = DataAD.find(e => e.MainTopic == MainTopicEsp && e.Subtopic == SupTopicSave);
        var newop = {
            year: year,
            month: month,
            day: day,
            men: manchange,
            child: childchange,
            women: womanchange,
            MainTopic: MainTopicEsp,
            Subtopic: SupTopicSave,
            id: eleM.id,
            // in: false,
            // out: true,
            counter: params,
            dayWeek: dayWeaka,
        }
        if (INoutCONDETION == "داخلية") {
            newop.in = true;
            newop.out = false;
        } else if (INoutCONDETION == "خارجية") {
            newop.in = false;
            newop.out = true;
        }
        // console.log(newop);
        DoneAll.push(newop);
        ///////////////////////////////////////////////////////////////////////

        drowTopic(sortTopic(DoneAll));

        overLay.style.display = "none";
    } else {
        alert("من فضلك اكمل باقي البيانات");
        if (!dayWeaka) {
            document.getElementById("startDateTime").style.border = "2px solid red";
        }
        if (!MainTopicEsp) {
            document.getElementById("MainTopicEsp").style.border = "2px solid red";
        }
        if (!SupTopicSave) {
            document.getElementById("SupTopicEsp").style.border = "2px solid red";
        }
        if (!INoutCONDETION) {
            document.getElementById("INoutCONDETION").style.border = "2px solid red";
        }
    }

}
//////////////////////////////////////////////////////////////////////////////////
let closeLay = () => {
    overLay.style.display = "none";
}
/////////////////////////////////////////////////////////////////////

generateMonthYear.addEventListener("click", () => {
    var dataMontlyAll = sortTopic(DoneAll);
    // console.log(dataMontlyAll)

    //////////////////////////////////////////////////////////////////
    var monthly = document.querySelector(".monthly");
    var monthlyCon = document.querySelector(".monthlyCon");
    monthlyCon.classList.remove("d-none")
    monthly.innerHTML = "";
    Object.keys(dataMontlyAll).forEach(ele => {
        let item = dataMontlyAll[ele];
        let info = ele.split("-")
        // console.log(item, info);
        monthly.innerHTML += `
        <p class="mt-2 text-center fw-bold">خطة شهر ${info[0]} (${monthNames[+(info[0]) - 1]}) لعام ${info[1]}</p>
        `;
        monthly.innerHTML += `
        <table class="table-group-divider" value = "خطة شهر ${info[0]} (${monthNames[+(info[0]) - 1]}) لعام ${info[1]}">
        <thead>
          <tr>
            <th style="width: 15%;">الموضوع الرئيسي</th>
            <th style="width: 15%;">الموضوع الفرعي</th>
            <th style="width: 6%;">ندوة داخلية</th>
            <th style="width: 6%;">مشورة عامة</th>
            <th style="width: 6%;">ندوة خارجية</th>
            <th style="width: 6%;">لفاء جماهيري</th>
            <th style="width: 6%;">ندوات قوافل</th>
            <th style="width: 6%;">أطفال</th>
            <th style="width: 6%;">ذكور</th>
            <th style="width: 6%;">إناث</th>
            <th style="width: 6%;">استخدام وسائل إعلامية</th>
            <th style="width: 6%;">انشطة إعلامية رقمية</th>
            <th style="width: 10%;">ملاحظــات</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      `;
        var BodyMonthly = document.querySelectorAll(".monthly tbody");
        BodyMonthly = BodyMonthly[BodyMonthly.length - 1];
        //   BodyMonthly.innerHTML = "";
        DataN.forEach(e => {
            let filIt = item.filter(z => e.id == z.id);
            let mmm = 0, chhhh = 0, woooom = 0, inTopic = 0, outTopic = 0;
            for (let i of filIt) {
                mmm += +(i.men);
                chhhh += +(i.child);
                woooom += +(i.women);
                inTopic += i.in ? 1 : 0;
                outTopic += i.out ? 1 : 0;
            }

            // console.log(mmm, chhhh, woooom, inTopic, outTopic);
            BodyMonthly.innerHTML += `
                <tr class = "${(inTopic || outTopic) ? "intopicandout" : ""}">
                    <td style="width: 15%;">${e.MainTopic}</td>
                    <td style="width: 15%;">${e.Subtopic}</td>
                    <td style="width: 6%;">${inTopic ? inTopic : ""}</td>
                    <td style="width: 6%;"></td>
                    <td style="width: 6%;">${outTopic ? outTopic : ""}</td>
                    <td style="width: 6%;"></td>
                    <td style="width: 6%;"></td>
                    <td style="width: 6%;">${(chhhh || mmm || woooom) ? chhhh : ""}</td>
                    <td style="width: 6%;">${(chhhh || mmm || woooom) ? mmm : ""}</td>
                    <td style="width: 6%;">${(chhhh || mmm || woooom) ? woooom : ""}</td>
                    <td style="width: 6%;"></td>
                    <td style="width: 6%;"></td>
                    <td style="width: 10%;"></td>
                </tr>`;
        })
        // console.log("==========");
        monthly.innerHTML += `<hr/>`
    })

    //////////////////////////////////////////////////////////////
    var yearly = document.querySelector(".yearly");
    yearly.innerHTML = "";
    yearly.innerHTML += `
    <p class="mt-2 text-center fw-bold">الخطة مجتمعة في جدول واحد</p>
    `;
    yearly.innerHTML += `
    <table class="table-group-divider" value = "الخطة المجمعة">
    <thead>
      <tr>
        <th style="width: 15%;">الموضوع الرئيسي</th>
        <th style="width: 15%;">الموضوع الفرعي</th>
        <th style="width: 6%;">ندوة داخلية</th>
        <th style="width: 6%;">مشورة عامة</th>
        <th style="width: 6%;">ندوة خارجية</th>
        <th style="width: 6%;">لفاء جماهيري</th>
        <th style="width: 6%;">ندوات قوافل</th>
        <th style="width: 6%;">أطفال</th>
        <th style="width: 6%;">ذكور</th>
        <th style="width: 6%;">إناث</th>
        <th style="width: 6%;">استخدام وسائل إعلامية</th>
        <th style="width: 6%;">انشطة إعلامية رقمية</th>
        <th style="width: 10%;">ملاحظــات</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  `;
    var boold = document.querySelector(".yearly tbody");
    DataN.forEach(element => {
        var manscount = 0, childcount = 0, womencount = 0, intpcoun = 0, outtpcoun = 0;
        for (let i of DoneAll) {
            if (i.id == element.id) {
                manscount += +(i.men);
                childcount += +(i.child);
                womencount += +(i.women);
                intpcoun += i.in ? 1 : 0;
                outtpcoun += i.out ? 1 : 0;
            }
        }
        boold.innerHTML += `
        <tr class = "${(intpcoun || outtpcoun) ? "intopicandout" : ""}">
            <td style="width: 15%;">${element.MainTopic}</td>
            <td style="width: 15%;">${element.Subtopic}</td>
            <td style="width: 6%;">${intpcoun ? intpcoun : ""}</td>
            <td style="width: 6%;"></td>
            <td style="width: 6%;">${outtpcoun ? outtpcoun : ""}</td>
            <td style="width: 6%;"></td>
            <td style="width: 6%;"></td>
            <td style="width: 6%;">${(childcount || manscount || womencount) ? childcount : ""}</td>
            <td style="width: 6%;">${(childcount || manscount || womencount) ? manscount : ""}</td>
            <td style="width: 6%;">${(childcount || manscount || womencount) ? womencount : ""}</td>
            <td style="width: 6%;"></td>
            <td style="width: 6%;"></td>
            <td style="width: 10%;"></td>
        </tr>`;
    })

    document.getElementById("download").classList.remove("d-none")
})

function downloadTablesOfTopics() {

    let tables = document.querySelectorAll(".monthlyCon table")
    // tables.add(tobo);

    var workbook = XLSX.utils.book_new();

    tables.forEach((table, index) => {
        var worksheet = XLSX.utils.table_to_sheet(table);

        worksheet['!margins'] = { RTL: true };

        for (let cell in worksheet) {
            if (worksheet.hasOwnProperty(cell) && cell[0] !== '!') {
                worksheet[cell].s = {
                    alignment: {
                        vertical: 'center',
                        horizontal: 'center'
                    }
                };
            }
        }

        let range = XLSX.utils.decode_range(worksheet['!ref']);
        worksheet['!cols'] = [];
        for (let C = range.s.c; C <= range.e.c; ++C) {
            let maxWidth = 10;
            for (let R = range.s.r; R <= range.e.r; ++R) {
                let cell_address = { c: C, r: R };
                let cell_ref = XLSX.utils.encode_cell(cell_address);
                let cell = worksheet[cell_ref];
                if (cell && cell.v) {
                    let cellValue = cell.v.toString();
                    maxWidth = Math.max(maxWidth, cellValue.length);
                }
            }
            worksheet['!cols'][C] = { width: maxWidth };
        }

        XLSX.utils.book_append_sheet(workbook, worksheet, table.getAttribute("value"));
    });

    workbook.Workbook = {
        Views: [{ RTL: true }]
    };

    var excelFile = XLSX.write(workbook, { bookType: 'xlsx', type: 'binary' });

    var blob = new Blob([s2ab(excelFile)], { type: "application/octet-stream" });

    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = "الخطة.xlsx";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

function s2ab(s) {
    var buf = new ArrayBuffer(s.length);
    var view = new Uint8Array(buf);
    for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
    return buf;
}

function downloadTableOfDetails() {
    var workbook = XLSX.utils.book_new();
    var worksheet = XLSX.utils.table_to_sheet(tobo);
    worksheet['!margins'] = { RTL: true };
    for (let cell in worksheet) {
        if (worksheet.hasOwnProperty(cell) && cell[0] !== '!') {
            worksheet[cell].s = {
                alignment: {
                    vertical: 'center',
                    horizontal: 'center'
                }
            };
        }
    }
    let range = XLSX.utils.decode_range(worksheet['!ref']);
    worksheet['!cols'] = [];
    for (let C = range.s.c; C <= range.e.c; ++C) {
        let maxWidth = 10;
        for (let R = range.s.r; R <= range.e.r; ++R) {
            let cell_address = { c: C, r: R };
            let cell_ref = XLSX.utils.encode_cell(cell_address);
            let cell = worksheet[cell_ref];
            if (cell && cell.v) {
                let cellValue = cell.v.toString();
                maxWidth = Math.max(maxWidth, cellValue.length);
            }
        }
        worksheet['!cols'][C] = { width: maxWidth };
    }
    XLSX.utils.book_append_sheet(workbook, worksheet, "الموضوعات اليومية");
    workbook.Workbook = {
        Views: [{ RTL: true }]
    };
    var excelFile = XLSX.write(workbook, { bookType: 'xlsx', type: 'binary' });
    var blob = new Blob([s2ab(excelFile)], { type: "application/octet-stream" });
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = "الموضوعات.xlsx";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

